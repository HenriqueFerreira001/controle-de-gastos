<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Planilha de Gastos</title>
    <style>
      :root {
        --bg: #0f1724;
        --card: #0b1220;
        --accent: #06b6d4;
        --muted: #94a3b8;
        --glass: rgba(255, 255, 255, 0.04);
        --success: #16a34a;
        --danger: #ef4444;
        --radius: 12px;
        font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto,
          "Helvetica Neue", Arial;
      }
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        background: linear-gradient(
          180deg,
          #071124 0%,
          #071124 40%,
          #031126 100%
        );
        color: #e6eef8;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 28px;
      }
      .wrap {
        width: 100%;
        max-width: 1100px;
      }
      header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 18px;
        flex-wrap: wrap;
        gap: 10px;
      }
      h1 {
        font-size: 20px;
        margin: 0;
      }
      .subtitle {
        color: var(--muted);
        font-size: 13px;
      }
      .grid {
        display: grid;
        grid-template-columns: 360px 1fr;
        gap: 18px;
      }

      .card {
        background: var(--card);
        border-radius: var(--radius);
        padding: 16px;
        box-shadow: 0 6px 20px rgba(2, 6, 23, 0.6);
      }

      form .row {
        display: flex;
        gap: 10px;
        margin-bottom: 10px;
      }
      label {
        font-size: 12px;
        color: var(--muted);
        display: block;
        margin-bottom: 6px;
      }
      input[type="text"],
      input[type="number"],
      input[type="date"],
      select {
        width: 100%;
        padding: 10px;
        border-radius: 8px;
        border: 1px solid rgba(255, 255, 255, 0.04);
        background: var(--glass);
        color: inherit;
      }
      button {
        background: var(--accent);
        border: none;
        padding: 10px 12px;
        border-radius: 10px;
        color: #042028;
        font-weight: 600;
        cursor: pointer;
      }
      .btn-ghost {
        background: transparent;
        border: 1px solid rgba(255, 255, 255, 0.06);
        color: var(--muted);
        padding: 8px 10px;
      }

      table {
        width: 100%;
        border-collapse: collapse;
      }
      thead th {
        font-size: 12px;
        text-align: left;
        color: var(--muted);
        padding: 8px 10px;
        border-bottom: 1px dashed rgba(255, 255, 255, 0.04);
      }
      tbody td {
        padding: 10px;
        border-bottom: 1px dashed rgba(255, 255, 255, 0.02);
        font-size: 14px;
      }
      .muted {
        color: var(--muted);
        font-size: 13px;
      }

      .controls {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
      }
      .summary {
        display: flex;
        gap: 10px;
        align-items: center;
        flex-wrap: wrap;
      }
      .pill {
        background: rgba(255, 255, 255, 0.03);
        padding: 8px 12px;
        border-radius: 999px;
        font-weight: 600;
      }

      .small {
        font-size: 12px;
        padding: 6px 8px;
        border-radius: 8px;
      }
      .danger {
        background: var(--danger);
        color: white;
      }
      .success {
        background: var(--success);
        color: white;
      }

      footer {
        margin-top: 12px;
        color: var(--muted);
        font-size: 13px;
        text-align: center;
      }

      @media (max-width: 880px) {
        .grid {
          grid-template-columns: 1fr;
        }
      }
      .cat-badge {
        display: inline-block;
        padding: 6px 8px;
        border-radius: 8px;
        font-size: 12px;
        background: rgba(255, 255, 255, 0.03);
      }
      .empty {
        padding: 26px;
        text-align: center;
        color: var(--muted);
      }
      .note {
        font-size: 12px;
        color: var(--muted);
        margin-top: 8px;
      }
    </style>
  </head>
  <body>
    <div class="wrap">
      <header>
        <div>
          <h1>Planilha de Gastos ‚Äî T√©cnica <strong>C.O.R.P.O.</strong></h1>
          <div class="subtitle">Controle total do seu dinheiro</div>
        </div>
        <div class="summary">
          <div class="pill">
            Saldo inicial:
            <input
              id="initialMoney"
              type="number"
              min="0"
              step="0.01"
              placeholder="0.00"
              style="
                width: 100px;
                padding: 4px;
                border-radius: 6px;
                border: none;
                background: var(--glass);
                color: #fff;
              "
            />
          </div>
          <div class="pill">
            Gasto total: <span id="totalDisplay">R$ 0,00</span>
          </div>
          <div class="pill">
            Saldo restante: <span id="balanceDisplay">R$ 0,00</span>
          </div>
        </div>
      </header>

      <main class="grid">
        <section class="card">
          <h3 style="margin-top: 0">Adicionar gasto</h3>
          <form id="expenseForm">
            <div class="row">
              <div style="flex: 1">
                <label>Descri√ß√£o</label>
                <input
                  id="desc"
                  type="text"
                  placeholder="Ex: Mercado"
                  required
                />
              </div>
            </div>
            <div class="row">
              <div style="flex: 1">
                <label>Categoria</label>
                <select id="category">
                  <option>Alimenta√ß√£o</option>
                  <option>Transporte</option>
                  <option>Lazer</option>
                  <option>Contas</option>
                  <option>Outros</option>
                </select>
              </div>
              <div style="width: 120px">
                <label>Data</label>
                <input id="date" type="date" required />
              </div>
            </div>
            <div class="row">
              <div style="flex: 1">
                <label>Valor (R$)</label>
                <input
                  id="value"
                  type="number"
                  step="0.01"
                  min="0"
                  placeholder="0.00"
                  required
                />
              </div>
              <div style="width: 120px; display: flex; align-items: flex-end">
                <button type="submit">Salvar</button>
              </div>
            </div>
          </form>
        </section>

        <section class="card">
          <h3>Gastos</h3>
          <table id="table">
            <thead>
              <tr>
                <th>Descri√ß√£o</th>
                <th>Categoria</th>
                <th>Data</th>
                <th>Valor</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="tbody"></tbody>
          </table>
          <div id="empty" class="empty">Nenhum gasto registrado.</div>
        </section>
      </main>

      <footer>Feito com a t√©cnica <strong>C.O.R.P.O.</strong></footer>
    </div>

    <script>
      const STORAGE_KEY = "planilha_corpo_v2";
      let expenses = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");
      let initialMoney = parseFloat(localStorage.getItem("initialMoney") || 0);

      const $ = (id) => document.getElementById(id);
      const totalDisplay = $("totalDisplay");
      const balanceDisplay = $("balanceDisplay");
      const initialInput = $("initialMoney");

      initialInput.value = initialMoney > 0 ? initialMoney.toFixed(2) : "";

      const formatCurrency = (v) =>
        Number(v || 0).toLocaleString("pt-BR", {
          style: "currency",
          currency: "BRL",
        });

      function save() {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(expenses));
        localStorage.setItem("initialMoney", initialMoney);
      }

      function render() {
        const tbody = $("tbody");
        tbody.innerHTML = "";
        if (expenses.length === 0) {
          $("empty").style.display = "block";
          $("table").style.display = "none";
        } else {
          $("empty").style.display = "none";
          $("table").style.display = "table";
        }
        let total = 0;
        expenses.forEach((e) => {
          total += Number(e.value);
          const tr = document.createElement("tr");
          tr.innerHTML = `<td>${e.desc}</td><td>${
            e.category
          }</td><td>${new Date(e.date).toLocaleDateString(
            "pt-BR"
          )}</td><td>${formatCurrency(
            e.value
          )}</td><td><button onclick="removeExpense('${
            e.id
          }')">üóëÔ∏è</button></td>`;
          tbody.appendChild(tr);
        });
        totalDisplay.textContent = formatCurrency(total);
        balanceDisplay.textContent = formatCurrency(initialMoney - total);
      }

      function removeExpense(id) {
        expenses = expenses.filter((e) => e.id !== id);
        save();
        render();
      }

      $("expenseForm").addEventListener("submit", (e) => {
        e.preventDefault();
        const desc = $("desc").value.trim();
        const category = $("category").value;
        const value = parseFloat($("value").value);
        const date = $("date").value;
        if (!desc || !date || value <= 0)
          return alert("Preencha os campos corretamente.");
        expenses.push({
          id: Date.now().toString(),
          desc,
          category,
          value,
          date,
        });
        save();
        render();
        e.target.reset();
      });

      initialInput.addEventListener("change", () => {
        initialMoney = parseFloat(initialInput.value || 0);
        save();
        render();
      });

      render();
    </script>
  </body>
</html>
